1 DIM A(2000)
2 DIM B(2000)
10 P = 0 
20 K = 0 
21 C = 0 
22 D = 0 
23 R = 0 
29 REM IscrtajOkvir
30 GOSUB 1000 
39 REM IspisiStatus
40 GOSUB 1600 
49 REM InicijalizujZmiju
50 GOSUB 1700
59 REM IscrtajZmiju
60 GOSUB 1900
69 REM IzracunajZvezdu
70 GOSUB 1500
80 CURSOR X, Y : PRINT "*";
90 IF K = 1 CURSOR 20, 1: PRINT "**** END ****  AGAIN ([ENTER]/ESC)"; : GOTO 4000
91 DELAY 200 - P 
95 G = ISKEY() 
100 IF (G = 4000) AND (S != 2) S = 0: GOTO 136  
110 IF (G = 4002) AND (S != 0) S = 2: GOTO 136  
120 IF (G = 4001) AND (S != 1) S = 3: GOTO 136  
130 IF (G = 4003) AND (S != 3) S = 1: GOTO 136  
135 IF G = 27 END 
136 GOSUB 2300
150 GOTO 90 
999 REM Iscrtaj okvir
1000 CLS 
1005 CURSOR 1, 2 
1010 PRINT "+";
1020 FOR I = 1 TO 78 
1030 PRINT "-";
1040 NEXT I
1050 PRINT "+" 
1060 FOR I = 3 TO 24 
1070 CURSOR 1, I 
1080 PRINT "|";
1085 PRINT "  "; 
1090 FOR J = 1 TO 4  
1100 PRINT "                   ";
1110 NEXT J
1120 PRINT "|";
1130 NEXT I
1140 CURSOR 1, 25
1150 PRINT "+";
1160 FOR I = 1 TO 78 
1170 PRINT "-";
1180 NEXT I
1190 PRINT "+" 
1200 RETURN
1499 REM IzracunajZvezdu
1500 X = 2 + RND(76) 
1510 Y = 3 + RND(21) 
1520 A(N + 1) = X 
1530 B(N + 1) = Y
1540 I = 0 
1550 IF A(I) != X I = I + 1: GOTO 1550
1560 IF B(I) != Y I = I + 1: GOTO 1550 
1570 IF I = (N + 1) RETURN 
1580 GOTO 1500 
1599 REM IspisiStatus
1600 CURSOR 1, 1 
1610 PRINT "POINTS: ", P;  
1620 RETURN
1700 N = 2 
1710 A(0) = 10 + RND(62)
1720 B(0) = 10 + RND(7)
1730 S = RND (3) 
1740 IF S = 0 A(1) = A(0): B(1) = B(0) + 1: A(2) = A(0): B(2) = B(0) + 2 : RETURN 
1750 IF S = 1 B(1) = B(0): A(1) = A(0) - 1: B(2) = B(0): A(2) = A(0) - 2 : RETURN 
1760 IF S = 2 A(1) = A(0): B(1) = B(0) - 1: A(2) = A(0): B(2) = B(0) - 2 : RETURN 
1770 RETURN
1900 CURSOR A(0), B(0) : PRINT "@";
1910 FOR I = 1 TO N  
1920 CURSOR A(I), B(I) : PRINT "O"; 
1930 NEXT I
1940 RETURN
1999 REM IzracunajPolozajGlave
2000 IF S = 0 C = A(0): D = B(0) - 1: RETURN  
2010 IF S = 1 C = A(0) + 1: D = B(0): RETURN  
2020 IF S = 2 C = A(0): D = B(0) + 1: RETURN  
2030 IF S = 3 C = A(0) - 1: D = B(0): RETURN  
2040 RETURN
2099 REM UKolizijiSaZidom
2100 IF C = 1 Z = 1 : RETURN 
2110 IF C = 80 Z = 1 : RETURN
2120 IF D = 2 Z = 1 : RETURN 
2130 IF D = 25 Z = 1 : RETURN
2140 Z = 0 : RETURN
2199 REM UKolizijiSaRepom
2200 A(1 + N) = C 
2210 B(1 + N) = D
2220 I = 1 
2230 IF C != A(I) I = I + 1 : GOTO 2230
2240 IF D != B(I) I = I + 1 : GOTO 2230 
2250 IF I <= N R = 1 : RETURN
2260 R = 0 
2270 RETURN
2998 REM PomeriZmiju
2999 REM IzracunajPolozajGlave
2300 GOSUB 2000
2309 REM UKolizijiSaZidom
2310 GOSUB 2100
2311 REM REM UKolizijiSaRepom
2312 GOSUB 2200
2320 IF (Z = 1) OR (R = 1) K = 1 : CURSOR C, D : PRINT "X"; : RETURN 
2340 IF (C = X) AND (D = Y) GOTO 2380
2370 GOTO 2550 
2379 REM ako je pojeo zvezdu
2380 CURSOR A(0), B(0)
2390 PRINT "O";
2400 CURSOR C, D 
2410 PRINT "@";
2420 N = N + 1 
2430 FOR I = N TO 1 STEP -1
2440 A(I) = A(I - 1)
2450 B(I) = B(I - 1) 
2460 NEXT I
2470 A(0) = C 
2480 B(0) = D
2490 P = P + 10
2499 REM IspisiStatus
2500 GOSUB 1600
2509 REM IzracunajZvezdu
2510 GOSUB 1500
2520 CURSOR X, Y 
2530 PRINT "*";
2540 RETURN
2549 REM else grana od PomeriZmiju
2550 CURSOR A(N), B(N) 
2560 PRINT " ";
2570 CURSOR A(0), B(0) 
2580 PRINT "O";
2590 CURSOR C, D 
2600 PRINT "@";
2610 FOR I = N TO 1 STEP -1
2620 A(I) = A(I - 1)
2630 B(I) = B(I - 1) 
2640 NEXT I
2680 A(0) = C 
2690 B(0) = D
2700 RETURN
3000 CURSOR 10, 30: PRINT "XY:", C, ", ", D
3010 CURSOR 10, 31: PRINT "SX, SY: ", X,", ", Y
3020 CURSOR 10, 32: PRINT "S:", S, ", N: ", N
3030 CURSOR 10, 33: PRINT "Z:", Z, ", R: ", R
3040 FOR J = N TO 0 STEP -1 : CURSOR 10, 34 + J: PRINT "ZX:", A(J), ", ZY: ", B(J): NEXT J 
3050 RETURN
4000 G = KEY() 
4001 PRINT G 
4010 IF G = 13 K = 0: CURSOR 20, 1: PRINT "                          "; : GOTO 10
4015 CLS 
4020 END 
