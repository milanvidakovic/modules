10 P = 0 
20 K = 0 
21 C = 0 
22 D = 0 
23 R = 0 
30 GOSUB 1000
40 GOSUB 1600
50 GOSUB 1700
60 GOSUB 1900
70 GOSUB 1500
80 CURSOR X, Y : PRINT "*";
90 IF K = 1 CURSOR 20, 1: PRINT "**** END ****  AGAIN ([ENTER]/ESC)"; : GOTO 4000
91 DELAY 50
95 G = ISKEY() 
100 IF (G = 4000) AND (S != 2) S = 0: GOTO 90 
110 IF (G = 4002) AND (S != 0) S = 2: GOTO 90 
120 IF (G = 4001) AND (S != 1) S = 3: GOTO 90 
130 IF (G = 4003) AND (S != 3) S = 1: GOTO 90 
135 IF G = 27 END 
136 GOSUB 2300
150 GOTO 90 
1000 CLS 
1005 CURSOR 1, 2 
1010 PRINT "+";
1020 FOR I = 1 TO 78 
1030 PRINT "-";
1040 NEXT I
1050 PRINT "+" 
1060 FOR I = 3 TO 24 
1070 CURSOR 1, I 
1080 PRINT "|";
1090 FOR J = 1 TO 78 
1100 PRINT " ";
1110 NEXT J
1120 PRINT "|";
1130 NEXT I
1140 CURSOR 1, 25
1150 PRINT "+";
1160 FOR I = 1 TO 78 
1170 PRINT "-";
1180 NEXT I
1190 PRINT "+" 
1200 RETURN
1500 X = 2 + RND(76) 
1510 Y = 3 + RND(21) 
1520 POKE N + 1, X 
1530 POKE (N + 2001), Y
1540 I = 0 
1550 IF PEEK(I) != X I = I + 1: GOTO 1550
1560 IF PEEK(2000 + I) != Y I = I + 1: GOTO 1550 
1570 IF I = (N + 1) RETURN 
1580 GOTO 1500 
1600 CURSOR 1, 1 
1610 PRINT "POINTS: ", P;  
1620 RETURN
1700 N = 2 
1710 POKE 0, (10 + RND(62))
1720 POKE 2000, (10 + RND(7))
1730 S = RND (3) 
1740 IF S = 0 POKE 1, PEEK (0): POKE 2001, (PEEK(2000) + 1): POKE 2, PEEK(0): POKE 2002, (PEEK(2000) + 2) : RETURN 
1750 IF S = 1 POKE 2001, PEEK (2000): POKE 1, (PEEK(0) - 1): POKE 2002, PEEK(2000): POKE 2, (PEEK(0) - 2) : RETURN 
1760 IF S = 2 POKE 1, PEEK (0): POKE 2001, (PEEK(2000) - 1): POKE 2, PEEK(0): POKE 2002, (PEEK(2000) - 2) : RETURN 
1770 RETURN
1900 CURSOR PEEK(0), PEEK (2000) : PRINT "@";
1910 FOR I = 1 TO N  
1920 CURSOR PEEK (I), PEEK (2000 + I) : PRINT "O"; 
1930 NEXT I
1940 RETURN
2000 IF S = 0 C = PEEK(0): D = PEEK(2000) - 1: RETURN  
2010 IF S = 1 C = PEEK(0) + 1: D = PEEK(2000): RETURN  
2020 IF S = 2 C = PEEK(0): D = PEEK(2000) + 1: RETURN  
2030 IF S = 3 C = PEEK(0) - 1: D = PEEK(2000): RETURN  
2040 RETURN
2100 IF C = 1 Z = 1 : RETURN 
2110 IF C = 80 Z = 1 : RETURN
2120 IF D = 2 Z = 1 : RETURN 
2130 IF D = 25 Z = 1 : RETURN
2140 Z = 0 : RETURN
2200 POKE 1 + N, C 
2210 POKE 2001 + N, D
2220 I = 1 
2230 IF C != PEEK (I) I = I + 1 : GOTO 2230
2240 IF D != PEEK (2000 + I) I = I + 1 : GOTO 2230 
2250 IF I <= N R = 1 : RETURN
2260 R = 0 : RETURN
2300 GOSUB 2000
2310 GOSUB 2100
2311 GOSUB 2200
2320 IF (Z = 1) OR (R = 1) K = 1 : CURSOR C, D : PRINT "X"; : RETURN 
2340 IF (C = X) AND (D = Y) GOTO 2380
2370 GOTO 2550 
2380 CURSOR PEEK(0), PEEK(2000)
2390 PRINT "O";
2400 CURSOR C, D 
2410 PRINT "@";
2420 N = N + 1 
2430 FOR I = N TO 1 STEP -1
2440 POKE I, PEEK (I - 1)
2450 POKE (2000 + I), PEEK(1999 + I) 
2460 NEXT I
2470 POKE 0, C 
2480 POKE 2000, D
2490 P = P + 10
2500 GOSUB 1600
2510 GOSUB 1500
2520 CURSOR X, Y 
2530 PRINT "*";
2540 RETURN
2550 CURSOR PEEK(N), PEEK (2000 + N) 
2560 PRINT " ";
2570 CURSOR PEEK(0), PEEK (2000) 
2580 PRINT "O";
2590 CURSOR C, D 
2600 PRINT "@";
2610 FOR I = N TO 1 STEP -1
2620 POKE I, PEEK (I - 1)
2630 POKE (2000 + I), PEEK(1999 + I) 
2640 NEXT I
2680 POKE 0, C 
2690 POKE 2000, D
2700 RETURN
3000 CURSOR 10, 30: PRINT "XY:", C, ", ", D
3010 CURSOR 10, 31: PRINT "SX, SY: ", X,", ", Y
3020 CURSOR 10, 32: PRINT "S:", S, ", N: ", N
3030 CURSOR 10, 33: PRINT "Z:", Z, ", R: ", R
3040 FOR J = N TO 0 STEP -1 : CURSOR 10, 34 + J: PRINT "ZX:", PEEK(J), ", ZY: ", PEEK (2000 + J): NEXT J 
3050 RETURN
4000 G = KEY() 
4001 PRINT G 
4010 IF G = 13 K = 0: CURSOR 20, 1: PRINT "                          "; : GOTO 10
4015 CLS 
4020 END 
